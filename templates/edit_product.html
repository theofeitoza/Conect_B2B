<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8"><title>Editar Produto - Connecta B2B</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form.css') }}">
    <style>
        .image-gallery-edit { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
        .image-preview { position: relative; }
        .image-preview img { width: 100px; height: 100px; object-fit: cover; border-radius: 5px; }
        .image-preview input { position: absolute; top: 5px; right: 5px; }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <a href="{{ url_for('dashboard') }}" style="text-decoration: none;"><h1 class="logo">Connecta B2B</h1></a>
            <nav class="main-nav">
                <ul>
                    <li><a href="{{ url_for('products') }}">Marketplace</a></li>
                    <li><a href="{{ url_for('notifications') }}" style="position: relative; padding: 5px;">&#128276; {% if unread_notifications > 0 %}<span style="position: absolute; top: 0; right: -5px; background: red; color: white; border-radius: 50%; padding: 2px 5px; font-size: 0.7rem;">{{ unread_notifications }}</span>{% endif %}</a></li>
                    <li><a href="{{ url_for('dashboard') }}"><strong>Olá, {{ session.company_name }}</strong></a></li>
                    <li><a href="{{ url_for('logout') }}" class="login-button">Sair</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <main>
        <section class="form-section">
            <div class="form-container">
                <h2 class="section-title">Editar Produto</h2>
                <form method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                        <label>Imagens Atuais (marcar para excluir)</label>
                        <div class="image-gallery-edit">
                            {% for image in product.images %}
                                <div class="image-preview">
                                    <img src="{{ url_for('static', filename='uploads/' + image.filename) }}">
                                    <input type="checkbox" name="delete_images" value="{{ image.id }}">
                                </div>
                            {% else %}
                                <p>Nenhuma imagem cadastrada.</p>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="form-group"><label for="product_images">Adicionar Novas Imagens</label><input type="file" id="product_images" name="product_images" accept="image/png, image/jpeg, image/gif" multiple></div>
                    <div class="form-group"><label for="name">Nome do Produto</label><input type="text" id="name" name="name" value="{{ product.name }}" required></div>
                    <div class="form-group"><label for="description">Descrição Técnica</label><textarea id="description" name="description" rows="4" style="width:100%; padding:10px;" required>{{ product.description }}</textarea></div>
                    <div class="form-group"><label for="category">Categoria</label><input type="text" id="category" name="category" value="{{ product.category }}" required></div>
                    <div class="form-group"><label for="base_price">Preço Base (R$)</label><input type="number" step="0.01" id="base_price" name="base_price" value="{{ product.base_price if product.base_price is not none }}"></div>
                    <button type="submit" class="submit-button">Salvar Alterações</button>
                </form>
            </div>
        </section>
    </main>
</body>
</html>